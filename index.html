<!DOCTYPE html>
<html lang="en"> <!-- class="modal-is-open modal-is-opening modal-is-closing" -->
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>WOW & Flutter Machine Config Generator</title>
		<link rel="icon" type="image/png" href="/images/favicon/favicon-96x96.png" sizes="96x96" />
		<link rel="icon" type="image/svg+xml" href="/images/favicon/favicon.svg" />
		<link rel="shortcut icon" href="/images/favicon/favicon.ico" />
		<link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png" />
		<meta name="apple-mobile-web-app-title" content="WOWConfig" />
		<link rel="manifest" href="/images/favicon/site.webmanifest" />
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.red.min.css">
		<link rel="stylesheet" href="/style.css">
		<script type="module" src="/petite-vue.js"></script>
	</head>
	<body v-scope>
		<header>
			<h1>
				<a href="https://headachesound.com" class="headache-sound">
					<span>Headache</span>
					Sound
				</a>
				<a href="https://headachesound.com/wowspec" class="wow-flutter">
					Wow & Flutter Machine
				</a>
			</h1>
			<h2>Config Generator</h2>
		</header>
		<main class="container">
			<p>Easily generate your <em>wow_settings.txt</em> config file with this handy tool. Simply click on the outlined controls, configure your desired settings, and the click the Download button to get your new config file.</p>
			<article id="image" class="image-container" v-effect="store.colour, updateTheme()">
				<div class="flex-container">
					<div class="image-section">
						<div class="image-wrapper">
							<img :src="`/images/${store.colour}.jpg`" class="wow-image" />
							<div id="platter" class="overlay circle" @click="nextColour()" ></div>
							<div id="speaker" class="overlay circle" @click="playWAV()"></div>
							<div id="effects" class="overlay highlight circle" @click="toggle('effects')" :data-tooltip="sectionSettings('effects')" data-placement="bottom"></div>
							<div id="pitch" class="overlay highlight circle" @click="toggle('pitch')" :data-tooltip="sectionSettings('pitch')" data-placement="left"></div>
							<div id="beat" class="overlay circle" @click="toggle('beat')"></div>
							<div id="sample" class="overlay highlight circle" @click="toggle('sample')" :data-tooltip="sectionSettings('sample')" data-placement="left"></div>
							<div id="fader" class="overlay highlight fader" @click="toggle('fader')" :data-tooltip="sectionSettings('fader')" data-placement="top"></div>
							<img v-show="store.looper" src="/images/looper.jpg" class="looper-image" />
							<div v-show="store.looper" id="looper" class="overlay highlight pill" @click="toggle('looper')" :data-tooltip="sectionSettings('looper')" data-placement="right"></div>
						</div>
						<form>
							<article class="form-article">
								<fieldset class="form-fieldset">
									<label>Colour
										<select name="colour" id="colour" v-model="store.colour" class="colour-select">
											<option v-for="colour in colours" :value="colour">{{ title(colour) }}</option>
										</select>
									</label>
									<label>
										Looper<br />
										<input type="checkbox" v-model="store.looper" role="switch" />
									</label>
								</fieldset>
							</article>
						</form>
					</div>
					<div class="controls-section">
						<form>
							<fieldset>
								<legend>Config File</legend>
								<div class="button-group">
									<button @click="download" data-tooltip="Download the config file generated by this tool"><span style="font-family: 'Material Icons Outlined';">download</span> Download</button>
									<button @click="upload" class="secondary" data-tooltip="Upload your existing config and apply its settings"><span style="font-family: 'Material Icons Outlined';">upload</span> Upload</button>
								</div>
							</fieldset>
							<label>
								<input type="checkbox" role="switch" v-model="store.minimal" />
								Minimal Config File
							</label>
							<button @click="reset" class="secondary" data-tooltip="Reset all settings to their default values"><span style="font-family: 'Material Icons Outlined';">refresh</span> Reset</button>
						</form>
						<pre class="config-display">{{ config }}</pre>
					</div>
				</div>
			</article>
		</main>
		<footer>
			<p>Wow Machine Config App by <a href="https://mark.honeychurch.org">Mark Honeychurch</a></p>
		</footer>
		<dialog :open="store.show === 'effects'">
			<article>
				<header v-scope="dialog('Effects')"></header>
				<div v-scope="select('effect_mode')"></div>
				<article v-show="store.settings.effect_mode.value === 'delay' || store.settings.effect_mode.value === 'both'">
					<h3>Delay</h3>
					<div class="grid">
						<div v-scope="slider('delay_length')"></div>
						<div v-scope="slider('delay_strength')"></div>
					</div>
				</article>
				<article v-show="store.settings.effect_mode.value === 'reverb' || store.settings.effect_mode.value === 'both'">
					<h3>Reverb</h3>
					<div class="grid">
						<div v-scope="slider('reverb_roomsize')"></div>
						<div v-scope="slider('reverb_strength')"></div>
						<div v-scope="slider('reverb_damping')"></div>
					</div>
					<div v-scope="slider('reverb_tone_low_pass_hz')"></div>
				</article>
			</article>
		</dialog>
		<dialog :open="store.show === 'pitch'">
			<article>
				<header v-scope="dialog('Pitch')"></header>
				<div v-scope="slider('33rpm_value')"></div>
				<div class="grid">
					<div v-scope="slider('pitch_range_min')"></div>
					<div v-scope="slider('pitch_range_max')"></div>
				</div>
			</article>
		</dialog>
		<dialog :open="store.show === 'sample'">
			<article>
				<header v-scope="dialog('Sample')"></header>
				<div v-scope="slider('wheel_response')"></div>
				<div v-scope="slider('sample_high_pass_frequency')"></div>
			</article>
		</dialog>
		<dialog :open="store.show === 'fader'">
			<article>
				<header v-scope="dialog('Fader')"></header>
				<div v-scope="slider('fader_calibrate_lag')"></div>
				<div class="grid">
					<article>
						<h3>Left</h3>
						<div v-scope="select('fader_left')"></div>
						<div v-scope="slider('left_cut_value')" @input="adjustFader('left')"></div>
					</article>
					<article>
						<h3>Right</h3>
						<div v-scope="select('fader_right')"></div>
						<div v-scope="slider('right_cut_value')" @input="adjustFader('right')"></div>
					</article>
				</div>
			</article>
		</dialog>
		<dialog :open="store.show === 'looper'">
			<article>
				<header v-scope="dialog('Looper')"></header>
				<div v-scope="select('looper_mode')"></div>
			</article>
		</dialog>
		<template id="slider">
			<label>
				{{ label }}: <strong>{{ prefix }}{{ store.settings[name].value }}{{ suffix }}</strong>
				<input type="range" :name="name" :min="min" :max="max" :step="step" v-model.number="store.settings[name].value" :title="tooltip" :class="{invert}" />
			</label>
		</template>
		<template id="select">
			<label>
				{{ label }}
				<select :name="name" v-model="store.settings[name].value" :title="tooltip">
					<option v-for="value in values" :value="value">{{ title(value) }}</option>
				</select>
			</label>
		</template>
		<template id="switch">
			<label>
				<input type="checkbox" role="switch" :name="name" v-model="store.settings[name].value" :title="tooltip" />
				{{ label }}
			</label>
		</template>

		<template id="dialog">
			<button aria-label="Close" @click="store.show = null" class="close"></button>
			<h3>{{ title }}</h3>
	</body>
</html>
